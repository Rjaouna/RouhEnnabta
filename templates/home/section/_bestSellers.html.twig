<style>
	/* Card */
	.product-card-new {
		cursor: pointer;
		background: #fff;
		border-radius: 16px;
		overflow: hidden;
		box-shadow: 0 10px 30px rgba(0, 0, 0, 0.06);
		transition: transform 0.3s ease, box-shadow 0.3s ease;
	}

	.product-card-new:hover {
		transform: translateY(-6px);
		box-shadow: 0 16px 40px rgba(0, 0, 0, 0.1);
	}

	.product-card-new:hover h3 {
		text-decoration: underline;
	}

	/* Image */
	.product-image {
		position: relative;
	}

	.product-image img {
		width: 100%;
		height: 230px;
		object-fit: cover;
		display: block;
	}

	.product-image::after {
		content: "";
		position: absolute;
		inset: 0;
		background: linear-gradient(to top, rgba(0,0,0,.25), transparent);
		pointer-events: none;
	}

	/* Badge */
	.product-badge {
		position: absolute;
		top: 15px;
		left: 15px;
		background: #c2a05c;
		color: #fff;
		padding: 4px 12px;
		border-radius: 20px;
		font-size: 12px;
		font-weight: 600;
	}

	/* Content */
	.product-content {
		padding: 20px;
	}

	.product-content h3 {
		font-size: 1.1rem;
		font-weight: 600;
		margin-bottom: 8px;
	}

	.product-content p {
		color: #7a7a7a;
		font-size: 0.95rem;
		margin-bottom: 16px;
	}

	/* Footer */
	.product-footer {
		display: flex;
		justify-content: space-between;
		align-items: center;
	}

	.price {
		font-weight: 700;
		font-size: 1.1rem;
		color: #2B2B2B;
	}
</style>

<section id="products" class="py-5 bg-soft-green">
	<div class="container">

		<div class="text-center mb-5">
			<h2 class="fw-bold text-primary-custom">Nos produits</h2>
			<p class="text-muted mt-2">
				Découvrez notre sélection de produits naturels issus du terroir marocain.
			</p>
		</div>

		<div
			class="row g-4" id="bestSellersContainer"><!-- Produits injectés via JS -->
		</div>

		<div class="text-center mt-5">
			<a href="#boutique" class="btn btn-primary px-4">
				Découvrir toute la gamme
			</a>
		</div>

	</div>
</section>


 <script>
document.addEventListener('DOMContentLoaded', () => {
const RECETTES_URL_TEMPLATE = "{{ path('product_recettes', { slug: 'SLUG_PLACEHOLDER' }) }}";
const PRODUCT_URL_TEMPLATE = "{{ path('product_show', { slug: 'SLUG_PLACEHOLDER' }) }}";




	const container = document.getElementById('bestSellersContainer');
	if (!container) return;

	container.innerHTML = `
		<div class="col-12 text-center text-muted">
			Chargement des produits...
		</div>
	`;

	fetch('/api/products')
		.then(res => res.json())
		.then(products => {

			container.innerHTML = '';

			products.slice(0, 4).forEach(p => {
const recettesUrl = RECETTES_URL_TEMPLATE.replace('SLUG_PLACEHOLDER', p.slug);
const prodauctUrl = PRODUCT_URL_TEMPLATE.replace('SLUG_PLACEHOLDER', p.slug);




				const image = p.mainImage
					? `/uploads/products/${p.mainImage}`
					: '/assets/img/placeholder-product.jpg';

				const description = p.description
					? p.description.substring(0, 30) + '…'
					: 'Produit naturel issu du terroir marocain.';

				container.insertAdjacentHTML('beforeend', `
<div class="col-6 col-md-3">


						<div class="product-card-new h-100">

							<div class="product-image">
								<img src="${image}" alt="${p.name}">
								<span class="product-badge">
									${p.categoryName ?? 'Produit'}
								</span>
							</div>

							<div class="product-content d-flex flex-column">

								<h3 class="text-success">${p.name}</h3>
								<p>${description}</p>

								${p.recettesCount > 0 ? `
									<div class="mb-3 small text-success d-flex align-items-center gap-1">
										<i class="bi bi-journal-text"></i>
										${p.recettesCount} recette${p.recettesCount > 1 ? 's' : ''}
									</div>
								` : ''}

								<div class="product-footer mt-auto">
								

									<div class="d-flex gap-2">
<a href="${prodauctUrl}"


										   class="btn btn-outline-success btn-sm rounded-pill">
											Produit
										</a>

										${p.recettesCount > 0 ? `
<a href="${recettesUrl}"

											   class="btn btn-success btn-sm rounded-pill">
												Recettes
											</a>
										` : ''}
									</div>
								</div>

							</div>

						</div>
					</div>
				`);
			});
		})
		.catch(() => {
			container.innerHTML = `
				<div class="col-12 text-center text-danger">
					Erreur lors du chargement des produits.
				</div>
			`;
		});
});

</script>



